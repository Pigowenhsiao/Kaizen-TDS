# INI for T2-EML processing with modified V1.5 script

[Basic_info]
Site = 350
ProductFamily = SAG FAB
Operation = T2-EML-Data # V1.5 XML Operation
TestStation = T2-EML    # V1.5 XML TestStation
file_name_pattern = FH*.xlsx # To find files like FHxxxx.xlsx
Data_date = 10 ; Days to look back, V1.5 (modified read_running_rec) will use this.

[Paths]
input_paths = Z:/MOCVD/MOCVD過去プログラム/F2炉/ ; Source Excel files
running_rec = ./T2-EML_F2_LastRun.txt ; For V1.5 date-based filtering state
output_path = C:/Temp/T2-EML/XML_Output/ ; **请更新为您实际的 XML 输出路径**
intermediate_data_path = C:/Temp/T2-EML/Intermediate/ ; **请更新为您实际的中间文件路径**
CSV_path = C:/Temp/T2-EML/CSV_Output/ ; **请更新为您实际的 CSV 输出路径**

[Excel]
sheet_name = Sheet1 ; **重要: T2-EML原脚本处理多个工作表。此处需指定一个工作表名。V1.5需修改才能处理多工作表。**
data_extraction_mode = cell_based ; **新增: 告诉V1.5使用基于单元格的读取模式**
# 以下 V1.5 标准参数在此模式下可能部分不适用或有不同含义
# data_columns = ; 在 cell_based 模式下不使用
main_skip_rows = 0 ; 在 cell_based 模式下通常不适用
main_dropna_key_col_idx = -1 ; 在 cell_based 模式下通常不适用

serial_number_key_name = key_serial_number ; **新增: 指定哪个 CellMapping 的 key 作为序列号用于SQL查询**
start_date_time_key_name = key_start_date_time ; **新增: 指定哪个 CellMapping 的 key 作为日期过滤的起始时间**

; XY坐标部分 (如果T2-EML数据不涉及V1.5意义上的XY点，则这些可以忽略或设为 optional)
xy_sheet_name =
xy_columns =
xy_sheet_is_optional = true
xy_coord_x_col_idx = 0
xy_coord_y_col_idx = 1
xy_num_points = 0

[Logging]
log_path = ../Log/T2-EML/ ; 建议为不同的流程使用不同的日志子目录

[CellMapping]
; 定义如何从指定单元格读取数据并映射到 DataFrame 的列名 (key)
; 格式: key_in_dataframe:CELL_ADDRESS:expected_type_for_conversion
; expected_type_for_conversion 将用于 V1.5 的 _apply_type_conversions (需要V1.5微调以支持按名转换)
; 'datetime_special' 是一个假设的类型，提示V1.5需要特殊处理 (例如替换 ' ' 为 'T')
fields =
    key_start_date_time:Q7:datetime_special
    key_serial_number:M8:str
    key_operator:V8:str
    key_batch_number:I8:str
    key_HeaderMisc1:U3:str
    key_HeaderMisc2:U4:str
    key_HeaderMisc3:U5:str
    key_Clad_2:M47:float
    key_Contact_2:M46:float
    key_Minimum_2:M48:float
    key_Clad_3:M52:float
    key_Contact_3:M51:float
    key_Step9_4:I21:float
    key_Step10_4:I22:float
    key_Step11_4:I23:float
    key_Step12_4:I24:float
    key_Step13_4:I25:float
    key_Step14_4:I26:float
    key_Step20_4:I27:float
    key_Step26_4:I28:float
    key_Step32_4:I29:float
    key_Step33_4:I30:float
    key_Step34_4:I31:float
    key_Step35_4:I32:float
    key_Step40_4:I33:float
    key_Step42_4:I34:float
    key_Step20_5:K27:float
    key_Step20_6:L27:float
    key_Step26_7:M28:float
    key_Step32_7:M29:float
    key_Step33_7:M30:float
    key_Step34_7:M31:float
    key_Step35_7:M32:float
    key_Step26_8:N28:float
    key_Step32_8:N29:float
    key_Step33_8:N30:float
    key_Step34_8:N31:float
    key_Step35_8:N32:float
    key_Step9_9:O21:float
    key_Step10_9:O22:float
    key_Step11_9:O23:float
    key_Step12_9:O24:float
    key_Step13_9:O25:float
    key_Step14_9:O26:float
    key_Step40_9:O33:float
    key_Step26_10:R28:float
    key_Step32_10:R29:float
    key_Step33_10:R30:float
    key_Step34_10:R31:float
    key_Step35_10:R32:float
    key_AsH3_11:T27:float
    key_Step9_12:U21:float
    key_Step10_12:U22:float
    key_Step11_12:U23:float
    key_Step12_12:U24:float
    key_Step13_12:U25:float
    key_Step14_12:U26:float
    key_Step20_12:U27:float
    key_Step26_12:U28:float
    key_Step40_12:U33:float
    key_Step42_12:U34:float
    key_Step13_13:X25:float
    key_Step14_13:X26:float
    key_Step20_13:X27:float
    key_Step26_13:X28:float
    key_Step32_13:X29:float
    key_Step33_13:X30:float
    key_Step34_13:X31:float
    key_Step35_13:X32:float
    key_Step9_14:Y21:float
    key_Step10_14:Y22:float
    key_Step11_14:Y23:float
    key_Step12_14:Y24:float
    key_Step9_15:Z21:float
    key_Step10_15:Z22:float
    key_Step11_15:Z23:float
    key_Step12_15:Z24:float
    key_Step13_15:Z25:float
    key_Step14_15:Z26:float
    key_Step20_15:Z27:float
    key_Step26_15:Z28:float
    key_Step32_15:Z29:float
    key_Step33_15:Z30:float
    key_Step34_15:Z31:float
    key_Step35_15:Z32:float
    key_Step40_15:Z33:float
    key_Step42_15:Z34:float
    key_F1_16:AE38:float
    key_F2-Start_16:AE44:float
    key_F2-Current_16:AE45:float
    key_F2-T2CH_16:AE46:float
    key_BallastN2_17:AE41:float
    key_MO1_18:K43:float
    key_MO2_18:L43:float
    key_MO3_18:M43:float
    key_MO4_18:N43:float
    key_MO5_18:O43:float
    key_MO6_18:P43:float
    key_Blank_18:Q43:str ; 原脚本有 replace('ー', '-'), 暂定为 str
    ; 原T2-EML脚本中的 Equipment1, Equipment2, Equipment3 是在Python中逻辑判断生成的，
    ; 如果需要这些，V1.5需要在_enrich_with_sql_data之后或类似阶段添加逻辑来创建这些列。
    ; 或者，如果它们来自固定单元格，也应在此处映射。

[ColumnMapping]
; 在 cell_based 模式下，DataFrame 的列名已经由 [CellMapping] 的 key 定义。
; 如果希望 CSV 的列标题与这些 key 不同，则可以在此定义映射。
; 格式: key_from_CellMapping:desired_CSV_header
; 如果 CSV 列标题与 CellMapping 中的 key 相同，则此部分可以留空或省略。
; 为保持 V1.5 结构，我们仍然可以解析它，但应用逻辑可能需要调整。
rename_map = key_start_date_time:StartTime,key_serial_number:SerialNumber,key_operator:Operator,key_batch_number:BatchNumber,key_HeaderMisc1:RecipeMacro,key_HeaderMisc2:RecipeProgram,key_HeaderMisc3:RecipeFolder

[XML_Defaults]
result_value = Passed
teststep_status_value = Passed
part_number_value = UNKNOWN ; 区分于其他流程的默认PN